{% extends "layout.html" %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h2>Словари</h2>
  <h6>v.{{ version }}</h6>
  {% if session.is_admin %}
  <a class="btn btn-success" href="{{ url_for('ui.new_dictionary_page') }}">+ Новый словарь</a>
  {% endif %}
</div>
<table class="table table-striped align-middle">
  <thead>
    <tr>
      <th>ID</th>
      <th>Язык</th>
      <th>Уровень</th>
      <th>Версия</th>
      <th>Слов</th>
      <th>Опубликован</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    {% for d in dictionaries %}
    <tr>
      <td>{{ d.id }}</td>
      <td>{{ d.language }}</td>
      <td>{{ d.level }}</td>
      <td>{{ d.version_str() }}</td>
      <td>{{ d.entries|length }}</td>
      <td>{{ 'Да' if d.published else 'Нет' }}</td>
      {% if session.is_admin %}
      <td class="d-flex gap-2">
        <form action="{{ url_for('ui.toggle_publish', dict_id=d.id) }}" method="post" style="display:inline;">
          <button class="btn btn-sm {{ 'btn-warning' if d.published else 'btn-success' }}" type="submit">
            {{ 'Снять с публикации' if d.published else 'Опубликовать' }}
          </button>
        </form>
        {% if not d.published %}
        <a class="btn btn-sm btn-primary" href="{{ url_for('ui.edit_dictionary', dict_id=d.id) }}">Редактировать</a>
        <form action="{{ url_for('ui.delete_dictionary', dict_id=d.id) }}" method="post" style="display:inline;"
              onsubmit="return confirm('Удалить словарь {{ d.language }} уровня {{ d.level }}?');">
          <button class="btn btn-sm btn-danger" type="submit">Удалить</button>
        </form>
        {% endif %}
      </td>
      {% endif %}
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
