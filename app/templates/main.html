{% extends 'base.html' %}
{% block title %}Portfolio — Projects & Timeline{% endblock %}

{% block content %}
<h2 class="text-xl font-semibold mb-4">Ongoing projects</h2>
<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
  {% for p in projects %}
    <article class="bg-white rounded-2xl p-4 shadow-md hover:shadow-xl transition">
      {% if p.image_url %}
        <img src="{{ url_for('ui_main.uploaded_file', filename=p.image_url) }}"
             alt="{{ p.title }}" class="rounded-lg mb-3">
      {% endif %}
      <h3 class="font-semibold">{{ p.title }}</h3>
      <p class="text-sm text-gray-600 mt-2">{{ p.summary }}</p>
      <div class="mt-3 flex flex-wrap gap-2">
        {% for t in (p.tags.split(',') if p.tags else []) %}
          <span class="text-xs px-2 py-1 bg-gray-100 rounded-full">#{{ t }}</span>
        {% endfor %}
      </div>
      <div class="mt-4 flex items-center justify-between text-sm text-gray-500">
<!--        <span>{{ p.date.strftime('%Y-%m-%d') }}</span>-->
        {% if p.link %}
          <a href="{{ p.link }}" class="font-medium text-indigo-600 hover:underline">Link →</a>
        {% endif %}
      </div>
    </article>
  {% endfor %}
</div>

<h2 class="text-xl font-semibold mt-12 mb-4">Timeline</h2>
<div id="timeline-container" class="relative">
  <div class="absolute left-8 top-0 bottom-0 w-px bg-gray-200"></div>

  <div id="events" class="space-y-12 pl-16 pr-4">
    {% for year, year_events in events_grouped.items() %}
      <!-- Разделитель года -->
      <div class="relative flex items-center mb-2">
        <span class="absolute -left-2 text-gray-400 text-sm font-medium">
          {{ year }}
        </span>
      </div>

      <div class="space-y-6">
        {% for it in year_events %}
          <div class="flex bg-white p-4 rounded-lg shadow-md hover:shadow-lg transition border-l-4 border-indigo-500">
            {% if it.image_url %}
              <div class="flex-shrink-0 w-32 h-32 overflow-hidden rounded-lg bg-gray-50 mr-4">
                <a href="{{ url_for('ui_main.download_file', filename=it.image_url) }}" title="Download image">
                  <img src="{{ url_for('ui_main.uploaded_file', filename=it.image_url) }}" alt="{{ it.title }}"
                       class="max-h-full max-w-full object-contain hover:opacity-80">
                </a>
              </div>
            {% endif %}
            <div class="flex-1">
              <div class="flex justify-between items-center mb-2">
                <h4 class="font-semibold text-indigo-600">{{ it.title }}</h4>
                <time class="text-xs text-gray-400">{{ it.date.strftime('%Y-%m-%d') }}</time>
              </div>
              <p class="text-sm text-gray-600">{{ it.summary }}</p>
              {% if it.tags %}
                <div class="flex flex-wrap gap-2 mt-2">
                  {% for t in it.tags.split(',') %}
                    <span class="text-xs px-2 py-1 bg-gray-100 rounded-full">#{{ t }}</span>
                  {% endfor %}
                </div>
              {% endif %}
              {% if it.link %}
                <a href="{{ it.link }}" target="_blank"
                   class="inline-block mt-2 text-sm text-indigo-600 hover:underline">Link →</a>
              {% endif %}
            </div>
          </div>
        {% endfor %}
      </div>
    {% endfor %}
  </div>
</div>

{% endblock %}
